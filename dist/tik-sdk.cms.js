!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@sentry/browser")):"function"==typeof define&&define.amd?define(["@sentry/browser"],t):"object"==typeof exports?exports.cms=t(require("@sentry/browser")):(e.tikSDK=e.tikSDK||{},e.tikSDK.cms=t(e.Sentry))}(this,(function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(4),n(5),n(6)],void 0===(o="function"==typeof(i=function(e,t,n,i){"use strict";function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}var o;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(t),n=(o=n)&&o.__esModule?o:{default:o},globalThis.tikSdkSession||(globalThis.tikSdkSession={authToken:null,instructorAuthToken:null});var r=class{constructor(){this.lookup_field="id",this.useCache={list:!1,get:!1},this.validateCache=!0}get base_domain(){return(0,i.base_domain)()}get base_url(){return(0,i.base_url)()}get session(){return globalThis.tikSdkSession}configCache(e,t){this.useCache=e,this._cacheTimeout&&clearInterval(this._cacheTimeout),t&&(this.cacheTimeout=t,this._cacheTimeout=setInterval(()=>{this.validateCache=!0},this.cacheTimeout))}async http(e,i,s,o=!1){i=i?`${this.resource}/${i}`:""+this.resource;let r,a={},l=`${this.base_url}${i}/`;if(s&&"GET"===e)l+=n.default.stringify(s,!0),s=null;else if(s)if(Object.values(s).some(e=>e instanceof File)){const e=new FormData;for(let[t,n]of Object.entries(s))null===n&&(n=""),e.append(t,n);s=e}else s=JSON.stringify(s),a={"Content-Type":"application/json; charset=utf-8"};else s=void 0;console.log(e,i,s||"");try{if(this.session.authToken&&(a.Authorization="Bearer "+this.session.authToken),r=await fetch(l,{method:e,headers:a,body:s,mode:"cors",cache:"no-cache",redirect:"follow",referrer:"no-referrer"}),!(r.ok||o&&[404,401].includes(r.status))){const e=new Error(r.statusText||r.status);throw e.response=r,e}if("DELETE"!==e)return await r.json()}catch(e){throw console.error("HTTP Error:",l.toString(),JSON.stringify(s),r&&r.status),console.log("Sentry",typeof t,t,Object.keys(t)),"object"==typeof t&&"captureException"in t&&t.captureException(e),e}}toObj(e){return e}async list(){if(this.useCache.list&&!this.validateCache&&this.data)console.log(`[HTTP] ${this.resource}.list(): using cache`);else{const e=await this.http("GET","");this.data=e,this.validateCache=!1}return this.data}async get(e,t=!1){if(e){const n=await this.http("GET",e,null,t);return this.toObj(n)}return this.new()}async save(e,t,n=!1,i=!1,s=!1){if(this.validateCache=!0,!e.id&&!t||n)return await this.http("POST","",e,s);{const n=await this.http(i?"PATCH":"PUT",t||e.id,e,s);return this.toObj(n)}}new(){return null}async delete(e){return this.validateCache=!0,this.http("DELETE",e)}};e.default=r})?i.apply(t,s):i)||(e.exports=o)},function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(0)],void 0===(o="function"==typeof(i=function(e,t){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.NewslettersApi=void 0,t=(n=t)&&n.__esModule?n:{default:n};class i extends t.default{constructor(){super(),this.resource="subscriptions"}async subscribe(e,t){console.log("Subscripton",e.email),await this.save({subject:t||process.env.NEWSLETTER_DEFAULT_SUBJECT,full_name:e.full_name||"utilisateur",email:e.email})}}e.NewslettersApi=i;var s=new i;e.default=s})?i.apply(t,s):i)||(e.exports=o)},function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(3),n(8),n(9),n(1),n(10)],void 0===(o="function"==typeof(i=function(e,t,n,i,s,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"forms",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"pages",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"posts",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"newsletters",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"notify",{enumerable:!0,get:function(){return o.default}}),t=r(t),n=r(n),i=r(i),s=r(s),o=r(o)})?i.apply(t,s):i)||(e.exports=o)},function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(0),n(1)],void 0===(o="function"==typeof(i=function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.FormsApi=void 0,t=i(t),n=i(n);class s extends t.default{constructor(){super(),this.resource="forms",this.configCache({list:!0},36e5)}name(e){return"name"in e?e.name:"full_name"in e?e.full_name:"first_name"in e?`${e.first_name} ${e.last_name||""}`:"fname"in e?`${e.fname} ${e.lname||""}`:""}async submit(e,t){if(!e)return void console.log("Ignore form...");let i;console.log("Submit form..."),e.status="inprogress";try{i=await this.http("POST",t+"/submit",e,!0),e.status="success",e.email&&await n.default.subscribe({email:e.email,full_name:this.name(e)})}catch(t){throw e.status="failure",t}}}e.FormsApi=s;var o=new s;e.default=o})?i.apply(t,s):i)||(e.exports=o)},function(t,n){t.exports=e},function(e,t,n){"use strict";var i=Object.prototype.hasOwnProperty;function s(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,s,r=[];for(s in"string"!=typeof t&&(t="?"),e)if(i.call(e,s)){if((n=e[s])||null!=n&&!isNaN(n)||(n=""),s=o(s),n=o(n),null===s||null===n)continue;r.push(s+"="+n)}return r.length?t+r.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,i={};t=n.exec(e);){var o=s(t[1]),r=s(t[2]);null===o||null===r||o in i||(i[o]=r)}return i}},function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(7)],void 0===(o="function"==typeof(i=function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setConfigValue=function(e,t){globalThis.tikSdkConfig[e]=t},e.setConfig=i,e.setConfigOrganization=function(e){i({API_BASE_URL:e.api_base_url,API_PREFIX:e.api_prefix,CACHE_PREFIX:e.cache_prefix})},e.base_domain=s,e.base_url=function(){return s()+globalThis.tikSdkConfig.API_PREFIX},e.default=void 0;const n={API_BASE_URL:"",API_PREFIX:"/api/",CACHE_PREFIX:"",VERSION:t.version,PROTOCOL:"https"};function i(e){for(const t of Object.keys(n))t in e&&(globalThis.tikSdkConfig[t]=e[t])}function s(){return globalThis.tikSdkConfig.API_BASE_URL}globalThis.tikSdkConfig||(globalThis.tikSdkConfig={}),function(){for(const e of Object.keys(n))e in globalThis.tikSdkConfig||(globalThis.tikSdkConfig[e]=n[e])}();var o=globalThis.tikSdkConfig;e.default=o})?i.apply(t,s):i)||(e.exports=o)},function(e){e.exports=JSON.parse('{"name":"tik-sdk","version":"2020.09.09","main":"index.js","module":"index.js","browser":"dist/tik-sdk.full.js","types":"types/tik-sdk.full.d.ts","exports":{".":"./index.js","./src/":"./src/"},"description":"TIK SDK","license":" GPL-3.0-only","author":{"name":"TIK (Technology Innovation Network)","email":"contact@tik.tn","url":"https://tik.tn"},"homepage":"https://tik.tn","private":true,"scripts":{"test":"jest","build:webpack":"webpack","build:babel":"babel index.js -d lib","lint":"eslint --ext .js,.vue,.ts --ignore-path .gitignore --ignore-pattern **/*.min.js ."},"browserslist":["last 2 versions","not IE 11","not IE_Mob 11","not dead"],"dependencies":{"@sentry/browser":"^5.5.0","@sentry/integrations":"^5.5.0","querystringify":"^2.1.1"},"devDependencies":{"@babel/cli":"^7.11.6","@babel/core":"^7.11.6","@babel/plugin-transform-modules-umd":"^7.10.4","@babel/preset-env":"^7.11.5","babel-eslint":"^10.0.1","babel-jest":"^26.3.0","babel-loader":"^8.1.0","clean-webpack-plugin":"^3.0.0","eslint":"^7.2.0","eslint-config-prettier":"^6.0.0","eslint-config-standard":">=12.0.0","eslint-loader":"^4.0.2","eslint-plugin-import":">=2.16.0","eslint-plugin-jest":">=24.0.0","eslint-plugin-node":">=8.0.1","eslint-plugin-prettier":"^3.0.1","eslint-plugin-promise":">=4.0.1","eslint-plugin-standard":">=4.0.0","husky":"^4.0.1","jest":"^26.4.2","lint-staged":"^10.3.0","nodemon":"^2.0.4","prettier":"^2.0.5","stylelint":"^13.1.0","ts-loader":"^8.0.3","typescript":"^4.0.2","webpack":"^4.44.1","webpack-cli":"^3.3.12"}}')},function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(0),n(1)],void 0===(o="function"==typeof(i=function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.PagesApi=void 0,t=i(t),n=i(n);class s extends t.default{constructor(){super(),this.resource="pages",this.configCache({list:!0},36e5)}}e.PagesApi=s;var o=new s;e.default=o})?i.apply(t,s):i)||(e.exports=o)},function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(0)],void 0===(o="function"==typeof(i=function(e,t){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.PostsApi=void 0,t=(n=t)&&n.__esModule?n:{default:n};class i extends t.default{constructor(){super(),this.resource="posts",this.configCache({list:!0},36e5)}}e.PostsApi=i;var s=new i;e.default=s})?i.apply(t,s):i)||(e.exports=o)},function(e,t,n){var i,s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t,n(1)],void 0===(o="function"==typeof(i=function(e,t){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.NotifyApi=void 0,t=(n=t)&&n.__esModule?n:{default:n};const i=["email","status","fname","lname","first_name","name","full_name","last_name","phone","target","message"];class s{message(e){let t="";const n=Object.keys(e).filter(e=>!i.includes(e));for(const i of n){let n=i.replace(/[_-]+/," ").toLowerCase(),s=e[i];s&&s.toString().trim(),t+=`${n}: ${s}\n`}return"message"in e&&(t+=`\nmessage:\n${e.message}\n`),t}name(e){return"name"in e?e.name:"full_name"in e?e.full_name:"first_name"in e?`${e.first_name} ${e.last_name||""}`:"fname"in e?`${e.fname} ${e.lname||""}`:""}async save(e){if(e&&e.email)return console.log("Submit form..."),e.status="inprogress",fetch("https://api.admin.tik.tn/feedbacks/notify",{method:"POST",redirect:"manual",credentials:"omit",refer:"",body:JSON.stringify({target:e.target||"New Submit - "+process.env.DISPLAY_NAME,subject:"",name:this.name(e),phone:e.phone||"",from:e.email,to:process.env.EMAIL,message:this.message(e)}),headers:{"Content-Type":"application/json"}}).then(async n=>{if(!n.ok)throw new Error("error");e.status="success",await t.default.subscribe({email:e.email,full_name:this.name(e)})}).catch(t=>{throw e.status="failure",new Error("error")});console.log("Ignore form...")}}e.NotifyApi=s;var o=new s;e.default=o})?i.apply(t,s):i)||(e.exports=o)}])}));
//# sourceMappingURL=tik-sdk.cms.js.map